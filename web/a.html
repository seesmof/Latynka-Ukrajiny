<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      Ukrainian Latynka Preview by the Grace of Jesus Christ for the Glory of
      GOD Almighty
    </title>

    <link
      href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body>
    <main class="p-4 h-screen flex flex-col justify-center gap-4">
      <section class="flex flex-col-reverse md:flex-row gap-4 flex-1">
        <textarea
          name="input"
          id="input"
          placeholder="Enter your Ukrainian cyrillic text here..."
          class="textarea resize-none textarea-bordered flex-grow"
        ></textarea>
        <textarea
          name="output"
          id="output"
          placeholder="Ukrainian latin text will be shown here..."
          class="textarea resize-none textarea-bordered flex-grow cursor-pointer select-none"
          readonly
        ></textarea>
      </section>
      <button class="btn btn-info text-white">Copy</button>
    </main>

    <script type="text/javascript">
      const concordance = {
        а: "a",
        б: "b",
        в: "v",
        г: "g",
        ґ: "ĝ",
        д: "d",
        дь: "d'",
        е: "e",
        є: "je",
        ж: "ž",
        з: "z",
        зь: "z'",
        и: "y",
        і: "i",
        ї: "ji",
        й: "j",
        к: "k",
        л: "l",
        ль: "l'",
        м: "m",
        н: "n",
        нь: "n'",
        о: "o",
        п: "p",
        р: "r",
        рь: "r'",
        с: "s",
        сь: "s'",
        т: "t",
        ть: "t'",
        у: "u",
        ф: "f",
        х: "h",
        ц: "c",
        ць: "c'",
        ч: "č",
        ш: "š",
        щ: "šč",
        ь: "'",
        ю: "ju",
        я: "ja",
        "'": "'",
      };

      const convert = (text) => {
        let output = "";
        for (let index = 0; index < text.length; index++) {
          const char = text.charAt(index);
          if (char.toLowerCase() in concordance) {
            let convertedLetter = concordance[char.toLowerCase()];
            if (char === char.toLowerCase()) {
              output += convertedLetter.toLowerCase();
            } else {
              if (index < text.length - 1) {
                const nextLetter = text.charAt(index + 1);
                output +=
                  nextLetter === nextLetter.toLowerCase()
                    ? `${convertedLetter
                        .charAt(0)
                        .toUpperCase()}${convertedLetter.slice(1)}`
                    : convertedLetter.toUpperCase();
              } else {
                const previousLetter = text.charAt(index - 1);
                output +=
                  previousLetter === previousLetter.toLowerCase()
                    ? `${convertedLetter
                        .charAt(0)
                        .toUpperCase()}${convertedLetter.slice(1)}`
                    : convertedLetter.toUpperCase();
              }
            }
          } else {
            output += char;
          }
        }

        return output;
      };

      const copyOutputText = () => {
        document.querySelector("#output").select();
        document.execCommand("copy");
      };

      document.querySelector("textarea").addEventListener("input", () => {
        let input = document.querySelector("textarea").value;
        let output = document.querySelector("#output");
        output.value = convert(input);
      });

      document
        .querySelector("button")
        .addEventListener("click", () => copyOutputText());
      document
        .querySelector("#output")
        .addEventListener("focus", () => copyOutputText());
    </script>
  </body>
</html>
